---
layout: post
title: Настройка Arch linux
---

Продолжаем тему установки. В первой статье мы рассмотрели минимальную установку archlinux, позволяющую запустить систему (ссылка в конце статьи). В этой - рассмотрим доведение системы до презентабильного вида.

## То, без чего невозможна настройка

```
pacman -S vim
```

## Создание пользователя

Для создания нового пользователя (не обладающего правами root) и задания паролей выполним следующие команды:

```
useradd -m -g users -G wheel -s /bin/bash vlad
passwd vlad
passwd
```

На этом этапе у вас скорее всего не будет работать команда sudo. Для исправления следует зайти в конфиг и добавить необходимые разрешения для группы wheel или только для своего пользователя.

```
sudoedit /etc/sudoers
```

## Настройка часового пояса и времени

```
mv /etc/localtime /etc/localtime.old
ln -s /usr/share/zoneinfo/Asia/Irkutsk /etc/localtime
hwclock --systohc --utc
```

Для обновления времени по сети необходимо настроить демон ntp.

```
pacman -S ntp
systemctl enable ntpd
```

## Настройка локали

Для настройки необходимо раскомментировать нужные строки и заново сгенерировать локали, после чего указать нужную.

```
vim /etc/locale.gen
locale-gen
echo "LANG=ru_RU.UTF-8" > /etc/locale.conf
```

## Настройка раскладки (для консоли)

Для указания шрифта и способа переключения раскладки открываем файл:

```
vim /etc/vconsole.conf
```

И указываем следующее:

```
KEYMAP=ruwin_alt_sh-UTF-8
FONT=UniCyr_8x16
```

## Настройка сетевого имени

Для указания сетевого имени выполняем:

```
echo "zalman" > /etc/hostname
```

Далее открываем файл:

```
vim /etc/hosts
```

И дописываем строчку:

```
127.0.0.1 zalman.localdomain zalman
```

## Настройка X

Настраивать будем тайловый оконный менеджер `i3wm`. Для авторизации используем `slim`. На первом шаге ставим X сервер и драйвера:

```
pacman -S xorg-server xorg-drivers
```

Вторым шагом ставим тайловый менеджер, меню запуска и окно входа:

```
pacman -S i3 dmenu slim
```

Что бы slim после удачной авторизации передавал управление дальше, в файле (под своим пользователем):

```
vim ~/.xinitrc
```

Необходимо указать:

```
exec i3
```

Далее прописываем окно авторизации в автозапуск (предварительно можно протестировать, заменив `enable` на `start`):

```
systemctl enable slim
```

### В этот момент я советую отвлечься, и настроить i3 менеджер и необходимые приложения. Для этого можно воспользоваться проектами, приведенными по ссылке в конце статьи.

## Настройка раскладки (для Х org)

Настройка раскладки перенесена в проект i3conf.

## "Полировка" системы

### Тема для окна авторизации

Окно входа по умолчанию выглядит хоть и хорошо, после консоли, но недостаточно. Установим другую тему.

```
pacman -S slim-themes archlinux-themes-slim
```

Что бы указать новую тему, откроем файл:

```
vim /etc/slim.conf
```

И изменим строчку с `current_theme` на это:

```
current_theme archlinux
```

### Тема для общего оформления системы

Для себя я выбрал тему [arc-theme](https://github.com/horst3180/Arc-theme). Для настройки нам понадобится утилита `lxappearance` и сама тема. Через утилиту переключаем тему на новую и настраиваем другие параметры, по необходимости.

```
pacman -S lxappearance arc-gtk-theme
```

Установим шрифты:

```
pacman -S ttf-droid
```

### Настройка ssh

Для настройки ssh необходимо установить пакет `openssh` и набор сетевых утилит `net-tools` (туда входит ifconfig).

```
pacman -S openssh net-tools
```

Для настройки серверного режима снимаем комментарий с порта (или ставим свой порт) в файле:

```
/etc/ssh/sshd_config
```

И настраиваем демон ssh в автозапуске:

```
systemctl enable sshd
```

### Настройка звука

Ставим alsa и pulseaudio.

```
Для управления:
alsamixer

Для проверки звука:
speaker-test -c 2
```

Возможные причины отсутствия звука:

**По умолчанию стоит не та карта**
Исправить можно в файле:

```
sudo vim /usr/share/alsa/alsa.conf
```

Указываем нужный номер карты:

```
defaults.ctl.card 0
defaults.pcm.card 0
```

**В i3 горячих клавишах указано неправильное имя устройства**

На крайний случай смотреть [сюда](https://www.reddit.com/r/i3wm/comments/2wbv8x/question_how_to_manage_audio_with_i3)

## Ссылки

* [Первая статья по установке](/20181104-install-arch)
* [Репозиторий для настройки i3wm (разовый)](https://github.com/vlad-ku/i3conf)
* [Репозиторий с конфиг файлами (постоянно меняется)](https://github.com/vlad-ku/home-conf)
